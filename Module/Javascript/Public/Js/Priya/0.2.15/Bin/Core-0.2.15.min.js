priya.active=function(){return document.activeElement},_("prototype").append=function(t){return this.appendChild(t),this},priya.append=_("prototype").append,priya.attribute=function(t,e){if("has"==t){for(i in this.attributes)if(void 0!==this.attributes[i].value&&this.attributes[i].name==e)return!0;return!1}if("remove"!=t){if(void 0===e){if(void 0===t){e={};for(i in this.attributes)void 0!==this.attributes[i].value&&(e[this.attributes[i].name]=this.attributes[i].value);return e}var i;e=null;for(i in this.attributes)this.attributes[i].name==t&&(e=this.attributes[i].value);return e}if("function"==typeof this.setAttribute)if(null===e)this.setAttribute(t,e);else if("object"==typeof e&&void 0!==e.nodeType){if(selector=e.tagName,"undefined"==typeof selector&&e instanceof HTMLDocument)return e;selector=selector.toLowerCase(),e.id&&(selector+=" #"+e.id),e.className&&(selector+=" ."+this.str_replace(" ",".",e.className)),this.setAttribute(t,selector)}else if("object"==typeof e)for(i in e)this.attribute(t+"-"+i,e[i]);else this.setAttribute(t,e);return e}this.removeAttribute(e)},priya.basename=function(t,e){var i=t,r=i.charAt(i.length-1);return"/"!==r&&"\\"!==r||(i=i.slice(0,-1)),i=i.replace(/^.*[\/\\]/g,""),"string"==typeof e&&i.substr(i.length-e.length)==e&&(i=i.substr(0,i.length-e.length)),i},priya.calculate=function(t){var e=null;switch(t){case"all":var i=this.getBoundingClientRect();(e={window:{},dimension:{}}).window.width=window.innerWidth,e.window.height=window.innerHeight;for(attribute in i)e.dimension[attribute]=i[attribute];var r=window.getComputedStyle(this);return e.margin={left:parseInt(r["margin-left"]),right:parseInt(r["margin-right"]),top:parseInt(r["margin-top"]),bottom:parseInt(r["margin-bottom"])},e.padding={left:parseInt(r["padding-left"]),right:parseInt(r["padding-right"]),top:parseInt(r["padding-top"]),bottom:parseInt(r["padding-bottom"])},e.border={left:parseInt(r["border-left-width"]),right:parseInt(r["border-right-width"]),top:parseInt(r["border-top-width"]),bottom:parseInt(r["border-bottom-width"])},e.top=e.dimension.top,e.bottom=e.window.height-e.dimension.bottom,e.height=e.dimension.height,e.width=e.dimension.width,e.left=e.dimension.left,e.right=e.dimension.right,e.offset={},e.offset.parent=this.createSelector(this.offsetParent),e.offset.left=this.offsetLeft,e.offset.top=this.offsetTop,this.data(e),e;case"offset":return(e={offset:{}}).offset.parent=this.createSelector(this.offsetParent),e.offset.left=this.offsetLeft,e.offset.top=this.offsetTop,this.data(e),e.offset;case"window-width":return e=window.innerWidth;case"window-height":return e=window.innerHeight;case"width":var o=this.className;return this.addClass("display-block overflow-auto"),e=this.offsetWidth,this.className=o,e;case"height":o=this.className;return this.addClass("display-block overflow-auto"),e=this.offsetHeight,this.className=o,e}},priya.children=function(t){var e,i;if(void 0===t){var r;for(e=this.childNodes,r=0;r<e.length;r++)e[r]=this.attach(e[r]);return e}if("first"==t||":first"==t)return this.attach(this.childNodes[0]);if("last"==t||":last"==t)return this.attach(this.childNodes[this.childNodes.length-1]);for(i=0;i<this.childNodes.length;i++)if(t==i)return this.attach(this.childNodes[i]);return!1},priya.addClass=function(t){var e,i=(t=this.str_replace("&&"," ",t)).split(" ");for(e=0;e<i.length;e++){var r,o=this.trim(i[e]);if(!this.empty(o))if(this.is_nodeList(this))for(r=0;r<this.length;r++){var s=this[r];!1===this.stristr(s.className,o)&&s.classList.add(o)}else!1===this.stristr(this.className,o)&&("object"==typeof this.classList?this.classList.add(o):(this.debug("error in classlist with "+this.classname+" "+o),console.log(this)))}return this},priya.removeClass=function(t){t=this.str_replace("&&"," ",t);if(void 0===this.className){for(e=0;e<this.length;e++)void 0!==this[e].className&&void 0!==this[e].Priya&&this[e].removeClass(t);return this}var e,i=t.split(" ");for(e=0;e<i.length;e++){var r=this.trim(i[e]);this.empty(r)||!1!==this.stristr(this.className,r)&&this.classList.remove(r)}return this},priya.toggleClass=function(t){t=this.str_replace("&&"," ",t);if(void 0===this.className){for(e=0;e<this.length;e++)void 0!==this[e].className&&void 0!==this[e].Priya&&this[e].toggleClass(t);return this}var e,i=t.split(" ");for(e=0;e<i.length;e++){var r=this.trim(i[e]);this.empty(r)||(!1!==this.stristr(this.className,r)?this.classList.remove(t):this.classList.add(t))}return this},priya.hasClass=function(t){t=this.str_replace("&&"," ",t);if(void 0===this.className){var e=new Array;for(i=0;i<this.length;i++)void 0!==this[i].className&&void 0!==this[i].Priya&&e.push(this[i].hasClass(t));for(i=0;i<e.length;i++)if(!1===e[i])return!1;return!0}var i,r=t.split(" ");for(i=0;i<r.length;i++){var o=this.trim(r[i]);if(!this.empty(o)&&!1!==this.stristr(this.className,o))return!0}return!1},priya.clone=function(t){var e=this.cloneNode(t);if(e=this.select(e),void 0!==this.Priya.eventListener)for(event in this.Priya.eventListener){var i,r=this.Priya.eventListener[event];for(i=0;i<r.length;i++){var o=r[i];e.on(event,o)}}return e},_("prototype").closest=function(t,e,i){var r;if(this.function_exists(e))return!1===(r=this.parent())?((o=this.attach(this.create("element",t))).data("selector",t),o):(!1===r[e](t,i)&&(r=r.closest(t,e,i)),r);if(void 0===e){var o;if("function"!=typeof this.parent)return(o=this.attach(this.create("element",t))).data("selector",t),o;r=this.parent()}else r=e.parent();if(!1===r)return(o=this.attach(this.create("element",t))).data("selector",t),o;if(this===r&&r===e&&(r=this.attach(this.parentNode)),r.tagName.toLowerCase()==t.toLowerCase())return r=this.attach(r);var s=r.select(t);return"object"==typeof s&&"PRIYA-NODE"==s.tagName&&(delete s,s=r.closest(t,r)),!1===s&&(s=r.closest(t,r)),s},priya.closest=_("prototype").closest,_("prototype").collection=function(t,e){return void 0!==t?void 0!==e?"delete"==t||"remove"==t?this.deleteCollection(e):(this.object_delete(t,this.collection()),this.object_set(t,e,this.collection()),this.object_get(t,this.collection())):"string"==typeof t?this.object_get(t,this.collection()):(this.setCollection(t),this.getCollection()):this.getCollection()},_("prototype").getCollection=function(t){return void 0===t?(void 0===this.collect&&(this.collect={}),this.collect):!!this.isset(this.collect[t])&&this.collect[t]},_("prototype").setCollection=function(t,e){var i;if("object"==typeof t)if("object"==typeof this.collect)for(i in t)this.collect[i]=t[i];else this.collect=t;else"object"==typeof this.collect?this.collect[t]=e:(this.collect={},this.collect[t]=e);this.collect=collection},_("prototype").deleteCollection=function(t){return this.object_delete(t,this.collect)},priya.collection=_("prototype").collection,priya.setCollection=_("prototype").setCollection,priya.getCollection=_("prototype").getCollection,priya.deleteCollection=_("prototype").deleteCollection,_("prototype").content=function(t){if("[object Function]"!=Object.prototype.toString.call(e))var e=window.priya;if(void 0!==t){if(void 0!==t.method)if(void 0!==t.target){if(void 0!==t.html||"replace"==t.method||"unwrap"==t.method){var i=e.select(t.target),r=t.method;if(this.is_nodeList(i)){var o=0;for(o=0;o<i.length;o++){var s=i[o];if("replace"==r)s.html(t.html);else if("replace-with"==r)s.html(t.html,"outer");else if("replace-or-append-to-body"==r){if("PRIYA-NODE"==s.nodeName)(s=e.select("body")).insertAdjacentHTML("beforeend",t.html);else s.html(t.html)}else if("replace-with-or-append-to-body"==r){if("PRIYA-NODE"==s.nodeName)(s=e.select("body")).insertAdjacentHTML("beforeend",t.html);else s.html(t.html,"outer")}else"append"==r||"beforeend"==r?s.insertAdjacentHTML("beforeend",t.html):"prepend"==r||"afterbegin"==r?s.insertAdjacentHTML("afterbegin",t.html):"after"==r||"afterend"==r?s.insertAdjacentHTML("afterend",t.html):"before"==r||"beforebegin"==r?s.insertAdjacentHTML("beforebegin",t.html):this.exception("write",this.dump("unknown method ("+r+") in content"))}}else if("replace"==r)i.html(t.html);else if("replace-with"==r)i.html(t.html,"outer");else if("replace-or-append-to-body"==r){if("PRIYA-NODE"==i.nodeName)(i=e.select("body")).insertAdjacentHTML("beforeend",t.html);else i.html(t.html)}else if("replace-with-or-append-to-body"==r){if("PRIYA-NODE"==i.nodeName)(i=e.select("body")).insertAdjacentHTML("beforeend",t.html);else i.html(t.html,"outer")}else"append"==r||"beforeend"==r?i.insertAdjacentHTML("beforeend",t.html):"prepend"==r||"afterbegin"==r?i.insertAdjacentHTML("afterbegin",t.html):"after"==r||"afterend"==r?i.insertAdjacentHTML("afterend",t.html):"before"==r||"beforebegin"==r?i.insertAdjacentHTML("beforebegin",t.html):this.exception("write",this.dump("unknown method ("+r+") in content"));return i}}else console.log("json.content failed (target)")}else console.log("json.content failed (data)")},priya.content=_("prototype").content,_("prototype").create=function(t,e){if("function"!=typeof t.toLowerCase)return console.log("no function toLowerCase______________________________________________"),console.log(t),console.log(e),void console.log(_("prototype").create.caller);switch(t.toLowerCase()){case"id":void 0===e&&(e="priya");var i=priya.collection("id."+e);this.empty(i)&&(i=[]);var r,o=1;for(r=0;r<i.length;r++)r>=o&&(o=r+1);return i[o]={id:e+"-"+o},priya.collection("id."+e,i),e+"-"+o;case"link":return(n=document.createElement("LINK")).rel="stylesheet","string"==typeof e?n.href=e:alert("todo"),n;case"script":return(n=document.createElement("SCRIPT")).type="text/javascript","string"==typeof e?n.src=e:alert("todo"),n;case"element":return(n=document.createElement("PRIYA-NODE")).className=this.str_replace("."," ",e),n.className=this.str_replace("#","",n.className),n.className=this.trim(n.className),this.attach(n);case"nodelist":var s=document.createDocumentFragment();if("[object Array]"===Object.prototype.toString.call(e)){var a;for(a=0;a<e.length;a++)s.appendChild(e[a]);s.childNodes.item=!1}else"object"==typeof e?(s.appendChild(e),s.childNodes.item=!1):void 0!==e&&console.log("unknown type ("+typeof e+") in priya.create()");return s.childNodes;default:var n=document.createElement(t.toUpperCase());return e&&(n.className=this.str_replace("."," ",e),n.className=this.str_replace("#","",n.className),n.className=this.trim(n.className)),this.attach(n)}return!1},priya.create=_("prototype").create,priya.createSelector=function(t){return this.empty(t)?"":(selector=t.tagName,"undefined"==typeof selector&&t instanceof HTMLDocument?t:(selector=selector.toLowerCase(),t.id&&(selector+=" #"+t.id),t.className&&(selector+=" ."+this.str_replace(" ",".",t.className)),selector))},priya.css=function(t,e){if(empty(e)&&0!==e&&"0"!==e)return void 0===this.style?"":this.computedStyle(t);if(void 0===this.style)return"";if("has"==t)return!!this.style[e];var i;if("delete"==t&&(this.style[e]=""),this.is_nodeList(this))for(i=0;i<this.length;i++){var r=this[i];e=r.computeStyle(t,e),r.style[t]=e}else e=this.computeStyle(t,e),this.style[t]=e},priya.computeStyle=function(t,e){if("top"==t&&"middle"==e)e="calc(50% - "+parseInt(this.css("height"))/2+"px)";else if("left"==t&&"center"==e){e="calc(50% - "+parseInt(this.css("width"))/2+"px)"}return e},priya.computedStyle=function(t){return this.Priya.style||(this.Priya.style=window.getComputedStyle(this)),t?this.Priya.style[t]:this.Priya.style},priya.data=function(t,e){if("remove"==t){if(this.attribute("has","data-"+e))return this.attribute("remove","data-"+e);if("object"==typeof(l=this.data(e))){var i=!1;for(h in l)this.data("remove",e+"-"+h),i=!0;return i}return console.log("error..."),console.log(this.attribute("has","data-"+e)),console.log(e),void console.log(l)}if("clear"==t&&"error"==e){if("FORM"==this.tagName){var r=this.select("input"),o=this.select("textarea"),s=this.select("select"),a=this.select(".dropdown");if(this.is_nodeList(r))for(n=0;n<r.length;n++){r[n].removeClass("error")}else r.removeClass("error");if(this.is_nodeList(o))for(n=0;n<o.length;n++){o[n].removeClass("error")}else o.removeClass("error");if(this.is_nodeList(s))for(n=0;n<s.length;n++){s[n].removeClass("error")}else s.removeClass("error");if(this.is_nodeList(a))for(n=0;n<a.length;n++){s[n].removeClass("error")}else a.removeClass("error")}}else if("serialize"==t){if("FORM"==this.tagName){var n,l=this.data();r=this.select("input"),o=this.select("textarea"),s=this.select("select");e=[];for(n in l){(f={}).name=n,f.value=l[n],e.push(f)}if(this.is_nodeList(r)){var c={};for(n=0;n<r.length;n++){if(!this.empty(r[n].name))if("checkbox"!=r[n].type||!0===r[n].checked)if(this.stristr(r[n].name,"[]"))this.isset(c[r[n].name])||(c[r[n].name]={},c[r[n].name].name=r[n].name.split("[]").join(""),c[r[n].name].value=[]),c[r[n].name].value.push(r[n].value);else(f={}).name=r[n].name,f.value=r[n].value,e.push(f)}for(name in c)e.push(c[name])}else{if(!this.empty(r.name))(f={}).name=r.name.split("[]").join(""),f.value=r.value,e.push(f)}if(this.is_nodeList(o)){c={};for(n=0;n<o.length;n++){if(!this.empty(o[n].name))if(this.stristr(o[n].name,"[]"))this.isset(c[o[n].name])||(c[o[n].name]={},c[o[n].name].name=o[n].name.split("[]").join(""),c[o[n].name].value=[]),c[o[n].name].value.push(o[n].value);else(f={}).name=o[n].name,f.value=o[n].value,e.push(f)}for(name in c)e.push(c[name])}else{if(!this.empty(o.name))(f={}).name=o.name.split("[]").join(""),f.value=o.value,e.push(f)}if(this.is_nodeList(s)){c={};for(n=0;n<s.length;n++){if(!this.empty(s[n].name))if(this.stristr(s[n].name,"[]"))this.isset(c[s[n].name])||(c[s[n].name]={},c[s[n].name].name=s[n].name.split("[]").join(""),c[s[n].name].value=[]),c[s[n].name].value.push(s[n].value);else(f={}).name=s[n].name,f.value=s[n].value,e.push(f)}for(name in c)e.push(c[name])}else{if(!this.empty(s.name))(f={}).name=s.name.split("[]").join(""),f.value=s.value,e.push(f)}return e}}else{if(void 0===t||"ignore"==t||"select"==t){var h;s=e;e={};for(h in this.attributes)if(void 0!==this.attributes[h].value){var p=this.stristr(this.attributes[h].name,"data-");if(!1!==p){if(p=this.attributes[h].name.substr(5),"ignore"==t){if("string"==typeof s&&p==s)continue;if("object"==typeof s&&this.in_array(p,s))continue}if("select"==t){if("string"==typeof s&&p!=s)continue;if("object"==typeof s&&!this.in_array(p,s))continue}var d=p.split(".");if(1==d.length)e[p]=this.attributes[h].value;else{var f=this.object_horizontal(d,this.attributes[h].value);e=this.object_merge(e,f)}}}return e}if("object"!=typeof t){l=this.attribute("data-"+t,e);if(this.empty(l)&&!this.empty(t)){l=this.data();c={};for(p in l)!1!==this.stristr(p,t)&&(c[this.str_replace(t+"-","",p)]=l[p]);return this.empty(c)?null:c}return l}for(h in t)this.data(h,t[h])}},_("prototype").debug=function(t){var e,i="Loading Debug...";(e=run(".debug"))||((e=priya.create("div","dialog no-select debug")).html('<div class="head"><i class="icon icon-bug"></i><h2>Debug</h2></div><div class="menu"><ul class="tab-head"><li class="tab-debug selected"><p>Debug</p></li><li class="tab-collection"><p>Collection</p></li><li class="tab-session"><p>Session</p></li></ul></div><div class="body"><div class="tab tab-body tab-debug selected"></div><div class="tab tab-body tab-collection"></div><div class="tab tab-body tab-session"></div></div><div class="footer"><button type="button" class="button-default button-close">Close</button><button type="button" class="button-default button-debug-clear"><i class="icon-trash"></i></button></div></div>'),priya.select("body").append(e),e.on("open",function(){e.select("div.head").closest(".debug").addClass("has-head"),e.select("div.menu").closest(".debug").addClass("has-menu"),e.select("div.icon").closest(".debug").addClass("has-icon"),e.select("div.footer").closest(".debug").addClass("has-footer"),priya.select(".debug").addClass("display-block"),e.loader("remove")}),e.on("close",function(){priya.select(".debug").removeClass("display-block")}),e.on("debug",function(){priya.select(".debug .tab-head li").removeClass("selected"),priya.select(".debug .tab-body").removeClass("selected"),priya.select(".debug .tab-body.tab-debug").addClass("selected")}),e.on("debug-clear",function(){run(".debug .tab-body.tab-debug").html("")}),e.on("collection",function(){priya.select(".debug .tab-head li").removeClass("selected"),priya.select(".debug .tab-body").removeClass("selected");var t=priya.select(".debug .tab-body.tab-collection");t.addClass("selected");var e=priya.collection();"function"==typeof JSON.decycle&&(e=JSON.decycle(e)),e=JSON.stringify(e,null,2),t.html("<pre>"+e+"</pre>")}),e.on("session",function(){priya.select(".debug .tab-head li").removeClass("selected"),priya.select(".debug .tab-body").removeClass("selected");var t=priya.select(".debug .tab-body.tab-session");t.addClass("selected");var e={method:"replace",target:".tab-body.tab-session"};priya.request(priya.collection("url")+"Priya.System.Session",e),t.html("<pre>Retrieving session...</pre>")}),e.select(".button-close").on("click",function(){e.trigger("close")}),e.select(".button-debug-clear").on("click",function(){e.trigger("debug-clear")}),e.select(".tab-head .tab-collection").on("click",function(){e.trigger("collection"),this.addClass("selected")}),e.select(".tab-head .tab-debug").on("click",function(){e.trigger("debug"),this.addClass("selected")}),e.select(".tab-head .tab-session").on("click",function(){e.trigger("session"),this.addClass("selected")}));var r=select(".debug .tab-body.tab-debug");if("string"==typeof t)"run"==t&&(t=i),(s=priya.create("pre","")).html(t),r.append(s),e.trigger("open"),t==i&&setTimeout(function(){s.remove()},1500);else if("object"==typeof t){var o,s,a=priya.collection("debug");if(a)for(o in a)priya.debug(o),delete t.index;"function"==typeof JSON.decycle&&(t=JSON.decycle(t)),t=JSON.stringify(t,null,2),(s=priya.create("pre","")).html(t),r.append(s);var n=r.closest("has","scrollbar","vertical");n.scrollbar("to",{x:0,y:n.scrollbar("height")}),e.trigger("open")}else e.trigger("open")},priya.debug=_("prototype").debug,_("prototype").empty=function(t){var e;if(""===t||0===t||"0"===t||null===t||!1===t||void 0===t)return!0;if("object"==typeof t){for(e in t)return!1;return!0}return!1},"undefined"!=typeof priya&&(priya.empty=_("prototype").empty),priya.exception=function(t,e){if("write"==t||"replace"==t)this.debug(e);else if("append"==t)this.debug(e);else{var i,r=!1;for(i in t)this.stristr(i,"\\exception")&&(r=!0,t=t[i]);if(this.empty(r))return;this.debug(JSON.stringify(t,null,2))}},_("prototype").explode_multi=function(t,e,i){var r,o=new Array;for(r=0;r<t.length;r++){var s,a=t[r];if(void 0!==i&&this.isset(i[r]))var n=this.explode(a.string.limit[r]);else n=this.explode(a,e);if(1!=n.length)for(s=0;s<n.length;s++){var l=n[s];o.push(l)}}return this.empty(o)&&o.push(e),o},priya.explode_multi=_("prototype").explode_multi,_("prototype").explode=function(t,e,i){if(arguments.length<2||void 0===t||void 0===e)return null;if(""===t||!1===t||null===t)return!1;if("function"==typeof t||"object"==typeof t||"function"==typeof e||"object"==typeof e)return{0:""};!0===t&&(t="1");var r=(e+="").split(t+="");return void 0===i?r:(0===i&&(i=1),i>0?i>=r.length?r:r.slice(0,i-1).concat([r.slice(i-1).join(t)]):-i>=r.length?[]:(r.splice(r.length+i),r))},priya.explode=_("prototype").explode,priya.init=function(t,e){return console.log("deprecated, use select or run"),void 0===t?this:"string"==typeof t?this.select(t):t},priya.find=function(t,e){if(!this.id){this.id=this.attribute("id","priya-find-"+this.rand(1e3,9999)+"-"+this.rand(1e3,9999)+"-"+this.rand(1e3,9999)+"-"+this.rand(1e3,9999));var i=!0}"object"==typeof t&&console.log(t),t="#"+this.id+" "+t;var r=document.querySelectorAll(t);if(i&&this.attribute("remove","id"),e){if(0==r.length){var o=this.attach(this.create("element",t));return o.data("selector",t),o}if(1==r.length)return this.attach(r[0]);for(item in r)r[item]=this.attach(r[item]);return this.attach(r)}return r},priya.function_exists=function(t){if("string"==typeof t){if(void 0===this)return!1;t="object"==typeof this.Priya?this[t]:this.window[t]}return"function"==typeof t},_("prototype").html=function(t,e){if(void 0===e&&(e="inner"),void 0===t)return this.innerHTML;if(!0===t){var i=this.attribute();t="<"+this.tagName.toLowerCase();for(attr in i)t+=" "+attr+'="'+i[attr]+'"';return t+=">"+this.innerHTML+"</"+this.tagName.toLowerCase()+">"}if("outer"==e){if(this.is_nodeList()){for(r=0;r<this.length;r++)this[r].outerHTML=t;return t}return this.outerHTML=t,this.outerHTML}if(this.is_nodeList()){var r;for(r=0;r<this.length;r++)this[r].innerHTML=t;return t}return this.innerHTML=t,this.innerHTML},priya.html=_("prototype").html,_("prototype").implode=function(t,e){var i="",r="",o="";if(1===arguments.length&&(e=t,t=""),"object"==typeof e){if("[object Array]"===Object.prototype.toString.call(e))return e.join(t);for(i in e)r+=o+e[i],o=t;return r}return e},priya.implode=_("prototype").implode,priya.in_array=function(t,e,i){var r="";if(i=!!i){for(r in e)if(e[r]===t)return!0}else for(r in e)if(e[r]==t)return!0;return!1},_("prototype").is_array=function(t){return!(!t||"object"!=typeof t)&&!!function(t){if(!t||"object"!=typeof t||"number"!=typeof t.length)return!1;var e=t.length;return t[t.length]="bogus",e!==t.length?(t.length-=1,!0):(delete t[t.length],!1)}(t)},priya.is_array=_("prototype").is_array,_("prototype").is_nodeList=function(t){void 0===t&&(t=this);var e=Object.prototype.toString.call(t);return"object"==typeof t&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(e)&&"number"==typeof t.length&&(0===t.length||"object"==typeof t[0]&&t[0].nodeType>0)},priya.is_nodeList=_("prototype").is_nodeList,priya.is_numeric=function(t){return("number"==typeof t||"string"==typeof t&&-1===" \n\r\t\f\v            ​\u2028\u2029　".indexOf(t.slice(-1)))&&""!==t&&!isNaN(t)},_("prototype").isset=function(){var t=arguments,e=t.length,i=0;if(0===e)return console.log("Empty isset"),!1;for(;i!==e;){if(void 0===t[i]||null===t[i])return!1;i++}return!0},priya.isset=_("prototype").isset,priya.jid=function(t){void 0===t&&(t="priya");var e=this.collection(t);if(this.empty(e))return"1";console.log(e)},priya.link=function(t,e){if(void 0!==t){if("string"==typeof t)t={link:[t]};if(this.isset(t.href))return priya.select("head").appendChild(t),priya.load++,t.addEventListener("load",function(t){priya.load--},!1),e&&(t.addEventListener("load",function(t){e()},!1),t.addEventListener("error",function(t){console.log("error"),e()},!1)),t;if(!this.isset(t.link))return console.log("no data link"),t;var i;for(i in t.link){"&lt;"==t.link[i].substr(0,4)&&(t.link[i]=t.link[i].toString().replace(/&lt;/g,"<").replace(/&gt;/g,">"));var r={method:"append",target:"head",html:t.link[i]};this.content(r)}return this}},priya.loader=function(t){if("remove"==t)return priya.select(".priya-gui-loader").addClass("fade-out"),void setTimeout(function(){priya.select(".priya-loader").remove()},1e4);var e=run("body"),i=priya.create("element","priya-loader");i.innerHTML='<div class="priya-gui-loader"></div>',e.append(i)},_("prototype").methods=function(){var t={};for(property in this)"function"==typeof this[property]&&(t[property]=this[property]);return t},priya.methods=_("prototype").methods,_("prototype").microtime=function(t){var e=(new Date).getTime()/1e3,i=parseInt(e,10);return t?e:Math.round(1e3*(e-i))/1e3+" "+i},priya.microtime=_("prototype").microtime,priya.naturalICompare=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),naturalCompare(t,e)},priya.naturalCompare=function(t,e){var i,r,o=1,s=0,a=0,n=String.alphabet;function l(t,e,r){if(r){for(i=e;(r=l(t,i))<76&&r>65;)++i;return+t.slice(e-1,i)}return(r=n&&n.indexOf(t.charAt(e)))>-1?r+76:(r=t.charCodeAt(e)||0)<45||r>127?r:r<46?65:r<48?r-1:r<58?r+18:r<65?r-11:r<91?r+11:r<97?r-37:r<123?r+5:r-63}if((t+="")!=(e+=""))for(;o;)if(r=l(t,s++),o=l(e,a++),r<76&&o<76&&r>66&&o>66&&(r=l(t,s,s),o=l(e,a,s=i),a=i),r!=o)return r<o?-1:1;return 0},priya.next=function(t){t||(t=this.tagName);var e,i,r=this.parentNode;for(e=0;e<r.childNodes.length;e++){var o=r.childNodes[e];if(o.isEqualNode(this))i=!0;else if(!empty(i)){if(void 0===o.tagName)continue;if(o.tagName.toLowerCase()==t.toLowerCase()){i=o;break}}}if(!0!==i&&!empty(i))return attach(i)},_("prototype").object_delete=function(t,e,i,r){if("string"==typeof t&&(t=this.explode_multi([".",":","->"],t)),this.is_array(t)&&(t=this.object_horizontal(t)),this.empty(t))return delete i[r],!0;var o;for(o in t){var s=t[o];return!!this.isset(e[o])&&this.object_delete(s,e[o],e,o)}},priya.object_delete=_("prototype").object_delete,_("prototype").object_get=function(t,e){if(this.empty(e))return e;if("string"==typeof t){t=this.explode_multi([".",":","->"],t);for(i in t)this.empty(t[i])&&delete t[i]}if(this.is_array(t)&&(t=this.object_horizontal(t)),this.empty(t))return e;var i;for(i in t)if(!this.empty(i)){t[i];if(this.isset(e[i]))return this.object_get(t[i],e[i])}return null},priya.object_get=_("prototype").object_get,_("prototype").object_horizontal=function(t,e,i){if(this.empty(i)&&(i="object"),this.empty(t))return!1;var r,o={},s=t.pop();for(r in t){var a=t[r];if(void 0===n){o[a]={};var n=o[a]}else n[a]={},n=n[a]}return void 0===n?o[s]=e:n[s]=e,o},priya.object_horizontal=_("prototype").object_horizontal,_("prototype").object_merge=function(t,e){var i;void 0===t&&(t={});for(i in e){var r=e[i];void 0===t[i]?t[i]=r:"object"==typeof r&&"object"==typeof t[i]?t[i]=this.object_merge(t[i],r):t[i]=r}return t},priya.object_merge=_("prototype").object_merge,_("prototype").object_set=function(t,e,i,r){var o;if(void 0===r&&(r="child"),"string"==typeof r&&"child"!=r&&(r="root"==r?i:this.object_get(r,i)),"string"==typeof t&&(t=this.explode_multi([".",":","->"],t)),this.is_array(t)&&(t=this.object_horizontal(t)),!this.empty(t))for(o in t){var s=t[o];if(this.isset(i[o])&&"object"==typeof i[o]){if(this.empty(s)&&"object"==typeof e){var a;for(a in e){var n=e[a];i[o][a]=n}return i[o]}return this.object_set(s,e,i[o],r)}if("object"==typeof s)return i[o]=new Object,this.object_set(s,e,i[o],r);i[o]=e}return"child"==r?e:r},priya.object_set=_("prototype").object_set,priya.off=function(t,e){console.log(this.Priya.eventListener),this.removeEventListener(t,e)},priya.on=function(t,e,i){if(void 0===this.Priya)return console.log("Priya undefined"),console.log(this),console.log(t),console.log(e),this;if("object"!=typeof this.Priya.eventListener&&(this.Priya.eventListener={}),"object"==typeof t){for(r=0;r<t.length;r++)this.on(t[r],e,i);return this}var r;if(void 0===this.Priya.eventListener[t]&&(this.Priya.eventListener[t]=new Array),i=!this.empty(i),this.Priya.eventListener[t].push(e),this.is_nodeList(this))for(r=0;r<this.length;r++){var o=this[r];void 0===e&&console.log("action undefined with event: "+t),o.addEventListener(t,e,i)}else this.addEventListener(t,e,i);return this},priya.previous=function(t){t||(t=this.tagName);var e,i,r=this.parentNode.childNodes;for(e=r.length-1;e>=0;e--){var o=r[e];if(o.isEqualNode(this))i=!0;else if(!empty(i)){if(void 0===o.tagName)continue;if(o.tagName.toLowerCase()==t.toLowerCase()){i=o;break}}}return!0===i||empty(i)?null:attach(i)},priya.rand=function(t,e){return 0===arguments.length&&(t=0,e=2147483647),Math.floor(Math.random()*(e-t+1))+t},priya.refresh=function(t){if(void 0!==t){if(!this.isset(t.refresh)){if("object"==typeof t)return;t={refresh:t}}return window.location.href=t.refresh,t}},priya.remove=function(){if(this.is_nodeList(this)){var t;for(t=0;t<this.length;t++){(e=this[t]).parentNode.removeChild(e)}return!0}var e;return null!=(e=this.parentNode)&&e.removeChild(this)},_("prototype").request=function(t,e,i){priya.collect.web.core;var r=this;if("object"==typeof t&&null!==t&&(e=t,console.log(t),console.log("object"),console.log(typeof t),t="",void 0!==e.altKey)){priya.debug("event");t=r.data("request"),delete(e=r.data()).request}if(empty(t)&&(t=r.data("request")),!empty(t)){if(empty(e)&&(e=empty(r.tagName)||"FORM"!=r.tagName?r.data():r.data("serialize")),empty(e))var o="GET";else{var s=e;if(delete s.mtime,delete s.request,empty(s))o="GET";else o="POST"}var a=new XMLHttpRequest;if(a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){if("{"==a.responseText.substr(0,1)&&"}"==a.responseText.substr(-1)){var e=JSON.parse(a.responseText);priya.link(e),priya.styler(e),priya.script(e),priya.content(e),priya.refresh(e),priya.exception(e),"function"==typeof i&&i(t,e)}else priya.debug(a.responseText);setTimeout(function(){priya.loader("remove")},500)}else{if(0==a.readyState||1==a.readyState||a.readyState,3==a.readyState){var r=priya.collection("request.microtime");time=microtime(!0),time>r+1.75&&priya.loader()}4==a.readyState&&console.log(a)}},"GET"==o)priya.collection("request.microtime",microtime(!0)),a.open("GET",t,!0),a.setRequestHeader("Content-Type","application/json"),a.send();else{priya.collection("request.microtime",microtime(!0)),a.open("POST",t,!0),a.setRequestHeader("Content-Type","application/json"),"function"==typeof JSON.decycle&&(e=JSON.decycle(e));var n=JSON.stringify(e);a.send(n)}}},priya.request=_("prototype").request,_("prototype").round=function(t,e,i){var r,o,s,a;if(e|=0,s=(t*=r=Math.pow(10,e))%1==.5*(a=t>0|-(t<0)),o=Math.floor(t),s)switch(i){case"PHP_ROUND_HALF_DOWN":t=o+(a<0);break;case"PHP_ROUND_HALF_EVEN":t=o+o%2*a;break;case"PHP_ROUND_HALF_ODD":t=o+!(o%2);break;default:t=o+(a>0)}return(s?t:Math.round(t))/r},priya.round=_("prototype").round,_("prototype").run=function(t){if("[object Function]"==Object.prototype.toString.call(priya))var e=this;else e=priya;var i=e.collection("require");if(i.toLoad==i.loaded){var r=select(t);if("PRIYA-NODE"==r.tagName||!1===r)return;var o=r.data("request");return empty(o)?("undefined"==typeof microtime&&priya.expose("prototype"),r.data("mtime",microtime(!0)),r):r.request(o)}setTimeout(function(){_("prototype").run(t)},1/30)},priya.run=_("prototype").run,priya.script=function(t,e){if(void 0!==t){if(this.isset(t.src)&&this.isset(t.type)&&"text/javascript"==t.type)return priya.select("head").appendChild(t),priya.load++,t.addEventListener("load",function(t){priya.load--},!1),e&&t.addEventListener("load",function(t){e()},!1),t;if("undefined"==typeof attempt&&(attempt=0),0!=parseInt(priya.load)&&attempt<500)return setTimeout(function(){priya.script(t,++attempt),priya.hit++},parseFloat(1/30)),t;if(!this.isset(t.script))return t;var i;for(i in t.script)"&lt;"==t.script[i].substr(0,4)&&(t.script[i]=t.script[i].toString().replace(/&lt;/g,"<").replace(/&gt;/g,">")),this.addScriptSrc(t.script[i]),this.addScriptText(t.script[i]);return this}},priya.addScriptSrc=function(t){var e=this.readTag(t);if(this.isset(e.tagName)&&"script"==e.tagName&&this.isset(e.src)){var i,r=document.createElement(e.tagName);for(i in e)"tagName"!=i&&r.setAttribute(i,e[i]);document.getElementsByTagName("head")[0].appendChild(r)}},priya.addScriptText=function(t){var e=this.readTag(t);if(this.isset(e.tagName)&&"script"==e.tagName){var i=this.explode("<"+e.tagName,t);if(this.isset(i[1])){i=this.explode("</"+e.tagName,i[1]),(i=this.explode(">",i[0])).shift();var r=this.trim(this.implode(">",i));if(delete i,!this.empty(r)){var o,s=document.createElement(e.tagName);for(o in e)"tagName"!=o&&!1===this.stristr(o,"[")&&!1===this.stristr(o,"'")&&s.setAttribute(o,e[o]);s.text=r,document.getElementsByTagName("head")[0].appendChild(s)}}}},priya.readTag=function(t){var e,i=this.explode(">",this.trim(t)),r={tagName:(i=this.explode(" ",this.trim(i[0])))[0].substr(1)};for(e in i){var o=this.explode('="',i[e]),s=this.explode('"',o[1]);o=o[0],this.empty(s)||(s.pop(),s=this.implode('"',s),r[o]=s)}return r},priya.scrollbar=function(t,e){if("y"==t||"top"==t)return this.data("scrollbar-y",this.scrollTop);if("x"==t||"left"==t)return this.data("scrollbar-x",this.scrollLeft);var i=this.offsetWidth-this.clientWidth,r=this.offsetHeight-this.clientHeight;if("width"==t)return this.data("scrollbar-width",i);if("height"==t)return this.data("scrollbar-height",r);if("all"==t){var o={y:this.scrollTop,x:this.scrollLeft,width:i,height:r};return this.data("scrollbar",o)}if("to"==t&&this.scrollTo(e.x,e.y),"has"==t){if(e&&"horizontal"==e)return this.scrollWidth>this.clientWidth;if(e&&"vertical"==e)return this.scrollHeight>this.clientHeight;var s=this.scrollWidth>this.clientWidth,a=this.scrollHeight>this.clientHeight;return!(!s&&!a)}},_("prototype").select=function(t){if(this.nodeName,"[object Function]"==Object.prototype.toString.call(o));else if("[object Window]"==Object.prototype.toString.call(this))a=window.priya;else{if("[object HTMLElement]"==Object.prototype.toString.call(this)&&isset(this.nodeName)&&"PRIYA-NODE"==this.nodeName)return!1;a=this}if(void 0===t||null===t)return(o=a.attach(a.create("element",t))).data("selector",t),o;var e=Object.prototype.toString.call(t);if("[object HTMLDocument]"===e)return(o=a.attach(a.create("element",t))).data("selector",t),o;if("[object HTMLBodyElement]"!==e){if("[object String]"===e){if("function"==typeof a.querySelectorAll)var i=a.find(t);else i=document.querySelectorAll(t);var r,o;for(r=0;r<i.length;r++){var s=i[r];"object"!=typeof s.Priya&&(s=a.attach(s)),i[r]=s}return 0==i.length?((o=a.attach(a.create("element",t))).data("selector",t),o):1==i.length?s:a.attach(i)}if("object"==typeof a.Priya)return a;if("object"==typeof t.Priya)return t;console.log(a),console.log(t),console.log(e),console.log("error, cannot attach ??? with priya.attach(object)");var a=a.attach(e);return console.log(a),a}if("object"==typeof a.Priya)return a;console.log("error, cannot attach ??? with priya.attach(object)")},priya.select=_("prototype").select,_("prototype").str_replace=function(t,e,i,r){var o,s=0,a=0,n="",l="",c=0,h=[].concat(t),p=[].concat(e),d=i,f="[object Array]"===Object.prototype.toString.call(p),u="[object Array]"===Object.prototype.toString.call(d);for(d=[].concat(d),r&&(this.window[r]=0),s=0,o=d.length;s<o;s++)if(""!==d[s])for(a=0,c=h.length;a<c;a++)n=d[s]+"",l=f?void 0!==p[a]?p[a]:"":p[0],d[s]=n.split(h[a]).join(l),r&&d[s]!==n&&(this.window[r]+=(n.length-d[s].length)/h[a].length);return u?d:d[0]},priya.str_replace=_("prototype").str_replace,priya.stristr=function(t,e,i){var r;return-1!=(r=(t+="").toLowerCase().indexOf((e+"").toLowerCase()))&&(i?t.substr(0,r):t.slice(r))},priya.styler=function(t,e){if(void 0!==t){if("string"==typeof t)t={style:[t]};if(!isset(t.style))return t;var i;for(i in t.style){"&lt;"==t.style[i].substr(0,4)&&(t.style[i]=t.style[i].toString().replace(/&lt;/g,"<").replace(/&gt;/g,">"));var r={method:"append",target:"head",html:t.style[i]};this.content(r)}return this}},priya.trigger=function(t,e,i){e=!this.empty(e),i=!this.empty(i);var r,o=new Event(t,{bubbles:e,cancelable:i});if(o.synthetic=!0,void 0===this.dispatchEvent)if(priya.is_nodelist(this))for(r=0;r<this.length;r++)node=this[r],node.dispatchEvent(o,!0);else console.log("dispatch problem"),console.log(this);else this.dispatchEvent(o,!0)},_("prototype").trim=function(t,e){var i,r=0,o=0;for(t+="",i=e?(e+="").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1"):" \n\r\t\f\v            ​\u2028\u2029　",r=t.length,o=0;o<r;o++)if(-1===i.indexOf(t.charAt(o))){t=t.substring(o);break}for(o=(r=t.length)-1;o>=0;o--)if(-1===i.indexOf(t.charAt(o))){t=t.substring(0,o+1);break}return-1===i.indexOf(t.charAt(0))?t:""},priya.trim=_("prototype").trim,priya.val=function(t){return void 0!==this.value&&(void 0!==t&&(this.value=t),this.value)};